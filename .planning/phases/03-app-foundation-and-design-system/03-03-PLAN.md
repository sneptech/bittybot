---
phase: 03-app-foundation-and-design-system
plan: 03
type: execute
wave: 2
depends_on:
  - "03-01"
files_modified:
  - lib/core/l10n/app_en.arb
  - lib/core/l10n/app_es.arb
  - lib/core/l10n/app_fr.arb
  - lib/core/l10n/app_ar.arb
  - lib/core/l10n/app_zh.arb
  - lib/core/l10n/app_ja.arb
  - lib/core/l10n/app_pt.arb
  - lib/core/l10n/app_de.arb
  - lib/core/l10n/app_ko.arb
  - lib/core/l10n/app_hi.arb
  - lib/core/l10n/app_localizations.dart
  - lib/core/l10n/app_localizations_en.dart
  - lib/core/l10n/app_localizations_es.dart
  - lib/core/l10n/app_localizations_fr.dart
  - lib/core/l10n/app_localizations_ar.dart
  - lib/core/l10n/app_localizations_zh.dart
  - lib/core/l10n/app_localizations_ja.dart
  - lib/core/l10n/app_localizations_pt.dart
  - lib/core/l10n/app_localizations_de.dart
  - lib/core/l10n/app_localizations_ko.dart
  - lib/core/l10n/app_localizations_hi.dart
autonomous: true
requirements:
  - UIUX-03

must_haves:
  truths:
    - "When device locale is set to any of the 10 supported languages, all app UI strings appear in that language"
    - "English ARB file is the template with description metadata for all keys"
    - "Error messages exist in both friendly and direct tones for all 10 languages"
    - "AppLocalizations code-gen produces type-safe accessors for all string keys"
  artifacts:
    - path: "lib/core/l10n/app_en.arb"
      provides: "Template ARB with all UI strings and error messages"
      contains: "@@locale"
    - path: "lib/core/l10n/app_ar.arb"
      provides: "Arabic translations (RTL test case)"
      contains: "@@locale"
    - path: "lib/core/l10n/app_localizations.dart"
      provides: "Generated AppLocalizations class with type-safe accessors"
      contains: "class AppLocalizations"
  key_links:
    - from: "l10n.yaml"
      to: "lib/core/l10n/app_en.arb"
      via: "template-arb-file configuration"
      pattern: "template-arb-file: app_en.arb"
    - from: "lib/core/l10n/app_localizations.dart"
      to: "lib/core/l10n/app_en.arb"
      via: "generated from ARB files by flutter gen-l10n"
      pattern: "AppLocalizations"
---

<objective>
Create ARB translation files for 10 languages (en, es, fr, ar, zh, ja, pt, de, ko, hi) with all Phase 3 UI strings and error messages in both tone variants, then run flutter gen-l10n to produce type-safe AppLocalizations.

Purpose: Localization is a foundation requirement (UIUX-03). The ARB files define every user-visible string; the generated AppLocalizations class is imported by all screens. Getting this right now means no hardcoded English strings leak into the app.

Output: 10 ARB files with translations and generated AppLocalizations class with type-safe accessors.
</objective>

<execution_context>
@/home/max/.claude/get-shit-done/workflows/execute-plan.md
@/home/max/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-app-foundation-and-design-system/03-RESEARCH.md
@.planning/phases/03-app-foundation-and-design-system/03-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create English template ARB and 9 translation ARB files</name>
  <files>
    lib/core/l10n/app_en.arb
    lib/core/l10n/app_es.arb
    lib/core/l10n/app_fr.arb
    lib/core/l10n/app_ar.arb
    lib/core/l10n/app_zh.arb
    lib/core/l10n/app_ja.arb
    lib/core/l10n/app_pt.arb
    lib/core/l10n/app_de.arb
    lib/core/l10n/app_ko.arb
    lib/core/l10n/app_hi.arb
  </files>
  <action>
    Create `lib/core/l10n/` directory.

    Create `app_en.arb` as the template file. It must include `@` metadata entries for all keys (descriptions). Include ALL Phase 3 strings:

    **App-level strings:**
    - `appName`: "BittyBot"
    - `settings`: "Settings"
    - `language`: "Language"
    - `errorToneLabel`: "Error message style"
    - `errorToneFriendly`: "Friendly"
    - `errorToneDirect`: "Direct"
    - `retry`: "Retry"
    - `cancel`: "Cancel"
    - `ok`: "OK"
    - `useDeviceLanguage`: "Use device language"
    - `loading`: "Loading..."

    **Error messages (both tones per UIUX-06):**
    - `modelNotLoadedFriendly`: "Hang on — the model is still warming up. This only happens once!"
    - `modelNotLoadedDirect`: "Model not loaded. Please wait for setup to complete."
    - `inputTooLongFriendly`: "Oops — that message is a bit too long. Try shortening it a little."
    - `inputTooLongDirect`: "Input exceeds maximum length. Shorten your message and try again."
    - `inferenceFailedFriendly`: "Hmm, something went wrong. Tap to retry."
    - `inferenceFailedDirect`: "Translation failed. Please retry."
    - `genericErrorFriendly`: "Something unexpected happened. Give it another try?"
    - `genericErrorDirect`: "An error occurred. Please try again."

    **Model loading screen strings:**
    - `modelLoadingTitle`: "Getting ready..."
    - `modelLoadingMessage`: "Setting up BittyBot for the first time. This only needs to happen once."
    - `modelLoadingError`: "Setup failed"

    For each of the 9 non-English ARB files, create the file with `@@locale` set correctly and provide translations. Use best-effort translations — these are real UI strings, not placeholders. The Arabic file (`app_ar.arb`) is especially important as the RTL test case.

    **Translation guidelines:**
    - Keep translations natural and idiomatic (not word-for-word literal)
    - Friendly tone messages should feel warm and conversational in each language
    - Direct tone messages should be clear and concise
    - Arabic translations must be grammatically correct RTL text
    - CJK translations (zh, ja, ko) should use appropriate honorific levels for a consumer app
    - Do not include `@` metadata entries in non-template files (only the template `app_en.arb` needs them)

    **Key count:** ~22 string keys per file.
  </action>
  <verify>
    All 10 ARB files exist in `lib/core/l10n/`.
    Each file is valid JSON (run `python3 -c "import json; json.load(open('FILE'))"` for each).
    `app_en.arb` has `@` metadata for every string key.
    All 10 files have the same set of string keys.
  </verify>
  <done>
    10 ARB files exist with consistent key sets. English template has full metadata. All translations are human-quality, not placeholder text.
  </done>
</task>

<task type="auto">
  <name>Task 2: Run flutter gen-l10n and verify generated code</name>
  <files>
    lib/core/l10n/app_localizations.dart
    lib/core/l10n/app_localizations_en.dart
    lib/core/l10n/app_localizations_es.dart
    lib/core/l10n/app_localizations_fr.dart
    lib/core/l10n/app_localizations_ar.dart
    lib/core/l10n/app_localizations_zh.dart
    lib/core/l10n/app_localizations_ja.dart
    lib/core/l10n/app_localizations_pt.dart
    lib/core/l10n/app_localizations_de.dart
    lib/core/l10n/app_localizations_ko.dart
    lib/core/l10n/app_localizations_hi.dart
  </files>
  <action>
    Run `flutter gen-l10n` from the project root. This reads `l10n.yaml` and generates:
    - `lib/core/l10n/app_localizations.dart` (base class with `localizationsDelegates` and `supportedLocales`)
    - `lib/core/l10n/app_localizations_XX.dart` (one per locale)

    Since `synthetic-package: false` is set in `l10n.yaml`, the generated files go directly into `lib/core/l10n/` and are importable via `package:bittybot/core/l10n/app_localizations.dart`.

    After generation, verify:
    1. `AppLocalizations` class has a getter for every ARB key (e.g., `l10n.appName`, `l10n.modelNotLoadedFriendly`)
    2. `AppLocalizations.supportedLocales` contains all 10 locales
    3. `AppLocalizations.localizationsDelegates` is accessible
    4. The generated code compiles without errors

    If `flutter gen-l10n` fails, check:
    - JSON syntax errors in ARB files (missing commas, unescaped quotes)
    - Key mismatches between template and translation files
    - `l10n.yaml` pointing to correct directory
  </action>
  <verify>
    `flutter gen-l10n` exits with code 0.
    `lib/core/l10n/app_localizations.dart` exists and contains `class AppLocalizations`.
    `flutter analyze` passes with no errors in generated files.
    Generated file count: 11 (1 base + 10 locale-specific).
  </verify>
  <done>
    `AppLocalizations` is generated with type-safe accessors for all 22+ string keys across 10 locales. Any widget can import and use `AppLocalizations.of(context)!.appName` etc.
  </done>
</task>

</tasks>

<verification>
1. `flutter gen-l10n` succeeds
2. `flutter analyze` passes
3. 10 ARB files exist with consistent key sets
4. Generated `AppLocalizations` has `supportedLocales` with 10 entries
5. Every error message key exists in both `Friendly` and `Direct` variants
6. Arabic ARB file contains RTL text
</verification>

<success_criteria>
All 10 ARB files contain quality translations for all UI strings. Generated AppLocalizations provides type-safe string accessors. The localization system is ready for MaterialApp to consume via `localizationsDelegates` and `supportedLocales`.
</success_criteria>

<output>
After completion, create `.planning/phases/03-app-foundation-and-design-system/03-03-SUMMARY.md`
</output>
