---
phase: 03-app-foundation-and-design-system
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pubspec.yaml
  - l10n.yaml
  - lib/main.dart
  - lib/core/db/app_database.dart
  - lib/core/db/app_database.g.dart
  - assets/google_fonts/Lato-Regular.ttf
  - assets/google_fonts/Lato-Bold.ttf
  - assets/google_fonts/Lato-Italic.ttf
  - assets/google_fonts/Lato-BoldItalic.ttf
  - assets/google_fonts/Lato-Light.ttf
  - assets/google_fonts/Lato-Thin.ttf
autonomous: true
requirements:
  - UIUX-02

must_haves:
  truths:
    - "Flutter project compiles and runs on both Android and iOS targets"
    - "All Phase 3 dependencies resolve without version conflicts"
    - "Lato font renders when runtime font fetching is disabled (offline mode)"
    - "Drift database initializes without errors"
  artifacts:
    - path: "pubspec.yaml"
      provides: "Project manifest with all Phase 3 dependencies"
      contains: "flutter_riverpod"
    - path: "l10n.yaml"
      provides: "Localization code-gen configuration"
      contains: "synthetic-package: false"
    - path: "lib/core/db/app_database.dart"
      provides: "Empty Drift database ready for Phase 4 tables"
      contains: "@DriftDatabase"
    - path: "assets/google_fonts/Lato-Regular.ttf"
      provides: "Bundled Lato font for offline use"
  key_links:
    - from: "pubspec.yaml"
      to: "assets/google_fonts/"
      via: "flutter assets declaration"
      pattern: "assets/google_fonts/"
    - from: "pubspec.yaml"
      to: "l10n.yaml"
      via: "generate: true flag"
      pattern: "generate: true"
---

<objective>
Bootstrap the Flutter project from scratch with all Phase 3 dependencies, bundled Lato font assets for offline use, localization code-gen configuration, and an empty Drift database stub for Phase 4.

Purpose: Every subsequent plan depends on having a compilable Flutter project with the correct dependency versions, font assets, and tooling configured. This is the foundation layer.

Output: A Flutter project that compiles cleanly with all dependencies resolved, Lato fonts bundled, l10n.yaml configured, and an empty Drift database ready for future tables.
</objective>

<execution_context>
@/home/max/.claude/get-shit-done/workflows/execute-plan.md
@/home/max/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-app-foundation-and-design-system/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Bootstrap Flutter project and configure dependencies</name>
  <files>
    pubspec.yaml
    l10n.yaml
    lib/main.dart
    android/app/build.gradle.kts
    analysis_options.yaml
  </files>
  <action>
    Run `flutter create --org com.bittybot --platforms=android,ios .` in the project root (the worktree). This creates the Flutter scaffold in-place.

    After creation, replace `pubspec.yaml` with the full Phase 3 dependency set:
    - dependencies: flutter (sdk), flutter_localizations (sdk), intl (any), flutter_riverpod (^3.2.1), riverpod_annotation (^4.0.2), google_fonts (^8.0.2), shared_preferences (^2.5.4), drift (^2.31.0), drift_flutter (^0.2.8), path_provider (^2.1.5)
    - dev_dependencies: flutter_test (sdk), riverpod_generator (^4.0.3), build_runner (^2.10.5), drift_dev (^2.31.0)
    - flutter section: `generate: true` and `assets: [assets/google_fonts/]`

    Create `l10n.yaml` in project root with:
    ```yaml
    arb-dir: lib/core/l10n
    template-arb-file: app_en.arb
    output-localization-file: app_localizations.dart
    output-class: AppLocalizations
    synthetic-package: false
    nullable-getter: false
    ```

    Run `flutter pub get` to resolve all dependencies. If Riverpod 3.2.1 has version conflicts on stable Flutter, try pinning to `flutter_riverpod: ^3.1.0` and `riverpod_annotation: ^4.0.1`.

    Ensure `analysis_options.yaml` includes recommended lints. The default from `flutter create` is fine.

    Note: `lib/main.dart` will be a minimal placeholder at this stage (just `runApp(MaterialApp())`) — the real main.dart is built in Plan 05.
  </action>
  <verify>
    Run `flutter pub get` — exit code 0, no version conflicts.
    Run `flutter analyze` — no errors (warnings acceptable).
    Confirm `l10n.yaml` exists and contains `synthetic-package: false`.
  </verify>
  <done>
    Flutter project compiles, all dependencies resolve, l10n.yaml is configured for source-based code generation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Bundle Lato font assets for offline use</name>
  <files>
    assets/google_fonts/Lato-Regular.ttf
    assets/google_fonts/Lato-Bold.ttf
    assets/google_fonts/Lato-Italic.ttf
    assets/google_fonts/Lato-BoldItalic.ttf
    assets/google_fonts/Lato-Light.ttf
    assets/google_fonts/Lato-Thin.ttf
  </files>
  <action>
    The `google_fonts` package looks for font files in `assets/google_fonts/` before attempting HTTP fetch. Since this is an offline app, fonts MUST be bundled.

    Download Lato font files from Google Fonts. The google_fonts package expects specific filenames matching the Google Fonts API naming. Use the following approach:

    1. Create `assets/google_fonts/` directory
    2. Download Lato font files. The easiest method: use `google_fonts` package's expected file naming. The package internally maps font names to filenames. For Lato, the expected files are named like `Lato-Regular.ttf`, `Lato-Bold.ttf`, etc.
    3. Download from: `https://fonts.google.com/download?family=Lato` (zip file containing all weights)
    4. Extract the TTF files into `assets/google_fonts/`

    Minimum required weights for the app's text theme: Regular (400), Bold (700). Include Light (300), Thin (100), Italic, and BoldItalic for completeness.

    Verify the `pubspec.yaml` `flutter.assets` section includes `- assets/google_fonts/`.
  </action>
  <verify>
    Confirm `assets/google_fonts/` directory contains at least `Lato-Regular.ttf` and `Lato-Bold.ttf`.
    Run `flutter pub get` to confirm asset declaration is valid.
  </verify>
  <done>
    Lato font files are bundled in the project assets and declared in pubspec.yaml. The google_fonts package will use these local files instead of attempting network fetch.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create empty Drift database stub</name>
  <files>
    lib/core/db/app_database.dart
    lib/core/db/app_database.g.dart
  </files>
  <action>
    Create `lib/core/db/app_database.dart` with an empty Drift database class:

    ```dart
    import 'package:drift/drift.dart';
    import 'package:drift_flutter/drift_flutter.dart';

    part 'app_database.g.dart';

    @DriftDatabase(tables: [])
    class AppDatabase extends _$AppDatabase {
      AppDatabase([QueryExecutor? executor])
          : super(executor ?? _openConnection());

      @override
      int get schemaVersion => 1;

      static QueryExecutor _openConnection() {
        return DriftNativeDatabase.createInBackground(
          DatabaseConnection.delayed(Future.sync(() {
            return LazyDatabase(() async {
              return DriftNativeDatabase('bittybot.db');
            });
          })),
        );
      }
    }
    ```

    Note: The exact Drift API for `drift_flutter` may differ. Check the drift_flutter package for the correct `DriftNativeDatabase` usage. A simpler approach:

    ```dart
    @DriftDatabase(tables: [])
    class AppDatabase extends _$AppDatabase {
      AppDatabase() : super(_openConnection());

      @override
      int get schemaVersion => 1;

      static QueryExecutor _openConnection() {
        return driftDatabase(name: 'bittybot');
      }
    }
    ```

    The `driftDatabase` function from `drift_flutter` handles platform-specific database location automatically.

    Run `dart run build_runner build --delete-conflicting-outputs` to generate the `.g.dart` file.

    This empty database will have zero tables — Phase 4 will add chat session and message tables.
  </action>
  <verify>
    Run `dart run build_runner build --delete-conflicting-outputs` — generates `app_database.g.dart` without errors.
    Run `flutter analyze` — no errors in database files.
  </verify>
  <done>
    Empty Drift database compiles and generates code. Phase 4 can add tables without setting up Drift infrastructure from scratch.
  </done>
</task>

</tasks>

<verification>
1. `flutter pub get` succeeds with zero version conflict errors
2. `flutter analyze` reports no errors
3. `l10n.yaml` exists at project root with `synthetic-package: false`
4. `assets/google_fonts/` contains Lato font files
5. `lib/core/db/app_database.dart` exists and its `.g.dart` file is generated
6. `dart run build_runner build` completes without errors
</verification>

<success_criteria>
The Flutter project is fully bootstrapped with all Phase 3 dependencies resolved, Lato fonts bundled for offline use, localization codegen configured, and Drift database stub ready. All subsequent plans can build on this foundation without dependency or tooling setup.
</success_criteria>

<output>
After completion, create `.planning/phases/03-app-foundation-and-design-system/03-01-SUMMARY.md`
</output>
